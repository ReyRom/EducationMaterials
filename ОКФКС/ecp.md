## Виды ЭП и их отличия
В законе описаны несколько видов электронной подписи: простая, неквалифицированная и квалифицированная.

_ФЗ «Об электронной подписи»_
Простая электронная подпись самая доступная. Это логин и пароль, которые подтверждают, что пользователь авторизовался в системе. А также одноразовые коды в смс или на скретч-картах, уведомления по электронной почте.

C помощью такой подписи можно совершать онлайн-покупки. Например, вы заходите в мобильный банк при помощи логина и пароля или подтверждаете оплату в интернете кодом из смс. По условиям договора с банком такая подпись равнозначна обычной.

Также подпись позволяет подтвердить обращение в органы власти или подписать заявку на услугу. Например, когда подаете документы на налоговый вычет в личном кабинете на сайте налоговой службы.

**Простая электронная подпись** уязвима, поэтому ее нельзя применять при работе с государственной или коммерческой тайной. Если вы работаете с имущественными и финансовыми документами, то лучше ее не использовать. Она не гарантирует, что документ не меняли и что его подписал нужный человек. Это будет проверять районный или арбитражный суд, если возникнет спорная ситуация.


**Неквалифицированная электронная подпись** формируется с помощью более сложных программ и функций для шифрования. Считается, что подделать подпись, созданную с помощью такой программы, невозможно или очень сложно. Эта подпись говорит: документ подписал такой-то человек в такое-то время и не менял его после.

Эту подпись используют во внутреннем электронном документообороте: в распоряжениях, письмах, приказах и некоторых кадровых документах. Ей подписывают договоры, контракты и агентские отчеты, но только если стороны заключили соглашение о доверии таким подписям и электронным документам.

https://journal.tinkoff.ru/media/e-doc__soglashenie-edo.pdf

_ст. 6 ФЗ «Об электронной подписи»_

Неквалифицированные подписи можно генерировать внутри компании или сервиса с помощью бесплатных инструментов. Государство не может контролировать неквалифицированную подпись: кто угодно может ее выдать и владеть ею, и она не защищена средствами, которым доверяют власти. Именно поэтому в судебных инстанциях не принимают такие подписи.

**Квалифицированная электронная подпись** — самый надежный вид электронной подписи. Она подтверждена квалифицированным сертификатом, специальным бумажным или электронным документом, отвечающим требованиям ФСБ. Программа, которая предназначена для работы с квалифицированной подписью, тоже отдельно сертифицирована ФСБ.

Квалифицированную КЭП для физлиц, доверенных лиц организаций и ИП выдают в удостоверяющих центрах. Это организации, которые прошли сертификацию ФСБ и аккредитацию у Минкомсвязи, уполномочены выдавать сертификаты электронных подписей и осуществлять услуги по криптозащите информации.

Руководители компаний и ИП получают КЭП только в налоговой.

Главное отличие квалифицированной подписи в том, что ее целостность дополнительно проверяется по двум реквизитам:

- Наличием в списке недействительных сертификатов — его можно скачать на сайте удостоверяющего центра. Это помогает определить, была ли подпись действительна, когда ее использовали.
- Наличием штампа времени. Этот показатель говорит, когда документ подписали, действовал ли сертификат и имел ли автор подписи полномочия.
Так определяют, что подпись не была утеряна, украдена или просрочена, когда ее использовали. Сертификат квалифицированной подписи необходимо обновлять каждый год — помнить, когда она перестает действовать, и вовремя заказывать перевыпуск.

У квалифицированной подписи есть два важных преимущества.

Взломать квалифицированную подпись почти невозможно — это потребует слишком больших вычислительных ресурсов. Если вы потеряете закрытый ключ, по вашему сигналу удостоверяющий центр или налоговая отзовет сертификат — подписывать документы с его помощью будет нельзя. Также нельзя передавать токен кому-то — если об этом узнает удостоверяющий центр или налоговая, то аннулируют подпись как скомпрометированную.

Ее можно использовать в любых операциях с электронными документами. Ей доверяют районные и арбитражные суды и налоговые инспекции, поэтому чаще всего ею подписывают электронные счета-фактуры, налоговые декларации и договоры.


```cs
internal class Program
{
    static void Main(string[] args)
    {
        // Генерация ключей
        var keys = KeyGenerator.GenerateKeys();
        Console.WriteLine($"Публичный ключ: {keys.PublicKey}");
        Console.WriteLine($"Закрытый ключ: {keys.PrivateKey}");

        // Создание подписи
        string licenseData = "UserLicense:12345";
        byte[] signature = DigitalSignature.CreateSignature(licenseData, keys.PrivateKey);
        Console.WriteLine($"Цифровая подпись: {Convert.ToBase64String(signature)}");
        // Проверка подписи
        bool isValid = DigitalSignatureValidator.ValidateSignature(licenseData, signature, keys.PublicKey);
        if (isValid)
        {
            Console.WriteLine("Подпись действительна. ПО может быть запущено.");
        }
        else
        {
            Console.WriteLine("Подпись недействительна. Доступ запрещен.");
        }
    }
}
public class DigitalSignature
{
    public static byte[] CreateSignature(string data, string privateKey)
    {
        using RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
        rsa.FromXmlString(privateKey);
        byte[] dataBytes = Encoding.UTF8.GetBytes(data);
        return rsa.SignData(dataBytes, SHA256.Create());
    }
}
public class KeyGenerator
{
    public static (string PublicKey, string PrivateKey) GenerateKeys()
    {
        using RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(2048);
        return (rsa.ToXmlString(false), rsa.ToXmlString(true));
    }
}

public class DigitalSignatureValidator
{
    public static bool ValidateSignature(string data, byte[] signature, string publicKey)
    {
        using RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();
        rsa.FromXmlString(publicKey);
        byte[] dataBytes = Encoding.UTF8.GetBytes(data);
        return rsa.VerifyData(dataBytes, SHA256.Create(), signature);
    }
}
```

https://habr.com/ru/companies/aktiv-company/articles/241221/